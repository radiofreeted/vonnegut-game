<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentic Lego Pattern Matching Game - Perfectly Centered Studs</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        #game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        #pattern-card, #building-area {
            width: 320px;
            height: 320px;
            border: 2px solid #333;
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(8, 1fr);
            gap: 2px;
            background-color: #ddd;
            padding: 10px;
        }
        .block {
            border-radius: 2px;
            cursor: pointer;
            position: relative;
            display: grid;
            gap: 2px;
            padding: 2px;
        }
        .stud {
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 7px;
            font-weight: bold;
            width: 24px;
            height: 24px;
            margin: auto;
        }
        .block-1x1 {
            grid-column: span 1;
            grid-row: span 1;
            grid-template-columns: 1fr;
            grid-template-rows: 1fr;
        }
        .block-1x2 {
            grid-column: span 2;
            grid-row: span 1;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr;
        }
        .block-2x2 {
            grid-column: span 2;
            grid-row: span 2;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }
        .block.selected {
            outline: 2px solid black;
        }
        .block.match::after {
            content: '✅';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
        }
        .block.mismatch::after {
            content: '❌';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
        }
        #check-button, #start-button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            color: white;
            border: none;
            border-radius: 4px;
        }
        #check-button {
            background-color: #4CAF50;
        }
        #check-button:hover {
            background-color: #45a049;
        }
        #start-button {
            background-color: #2196F3;
        }
        #start-button:hover {
            background-color: #1e88e5;
        }
        #timer {
            font-size: 24px;
            font-weight: bold;
            margin-top: 20px;
        }
        #message {
            font-size: 18px;
            margin-top: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>Authentic Lego Pattern Matching Game</h1>
        <div id="pattern-card"></div>
        <div id="building-area"></div>
        <button id="check-button" disabled>Check Pattern</button>
        <button id="start-button">Start Game</button>
        <div id="timer">04:00</div>
        <div id="message"></div>
    </div>

    <script>
        const colors = ['#FF0000', '#0000FF', '#008000', '#FFFF00', '#FFA500', '#A52A2A'];
        const blockTypes = ['block-1x1', 'block-1x2', 'block-2x2'];
        const patternCard = document.getElementById('pattern-card');
        const buildingArea = document.getElementById('building-area');
        const checkButton = document.getElementById('check-button');
        const startButton = document.getElementById('start-button');
        const timerDisplay = document.getElementById('timer');
        const messageDisplay = document.getElementById('message');
        let timeLeft = 240; // 4 minutes in seconds
        let timerInterval;
        let selectedBlock = null;

        function createBlock(size, color) {
            const block = document.createElement('div');
            block.classList.add('block', size);
            block.style.backgroundColor = color;
            
            let studCount;
            switch(size) {
                case 'block-1x1': studCount = 1; break;
                case 'block-1x2': studCount = 2; break;
                case 'block-2x2': studCount = 4; break;
            }
            
            for (let i = 0; i < studCount; i++) {
                const stud = document.createElement('div');
                stud.classList.add('stud');
                stud.textContent = 'MAXO';
                stud.style.color = adjustColor(color, -30);
                block.appendChild(stud);
            }
            return block;
        }

        function adjustColor(color, amount) {
            return '#' + color.replace(/^#/, '').replace(/../g, color => ('0'+Math.min(255, Math.max(0, parseInt(color, 16) + amount)).toString(16)).substr(-2));
        }

        function generatePattern() {
            patternCard.innerHTML = '';
            const pattern = [];
            for (let i = 0; i < 64; i += 2) {
                const size = blockTypes[Math.floor(Math.random() * blockTypes.length)];
                const color = colors[Math.floor(Math.random() * colors.length)];
                const block = createBlock(size, color);
                patternCard.appendChild(block);
                pattern.push({ size, color });
                
                if (size === 'block-1x2') i++;
                if (size === 'block-2x2') i += 3;
            }
            return pattern;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function setupBuildingArea(pattern) {
            buildingArea.innerHTML = '';
            const shuffledPattern = shuffleArray([...pattern]);
            shuffledPattern.forEach(({ size, color }) => {
                const block = createBlock(size, color);
                block.addEventListener('click', () => {
                    if (selectedBlock === null) {
                        selectedBlock = block;
                        block.classList.add('selected');
                    } else if (selectedBlock === block) {
                        selectedBlock.classList.remove('selected');
                        selectedBlock = null;
                    } else {
                        const tempHTML = selectedBlock.innerHTML;
                        const tempColor = selectedBlock.style.backgroundColor;
                        const tempClass = selectedBlock.className;
                        
                        selectedBlock.innerHTML = block.innerHTML;
                        selectedBlock.style.backgroundColor = block.style.backgroundColor;
                        selectedBlock.className = block.className;
                        
                        block.innerHTML = tempHTML;
                        block.style.backgroundColor = tempColor;
                        block.className = tempClass;
                        
                        selectedBlock.classList.remove('selected');
                        selectedBlock = null;
                    }
                });
                buildingArea.appendChild(block);
            });
        }

        function checkPattern() {
            const patternBlocks = patternCard.querySelectorAll('.block');
            const buildingBlocks = buildingArea.querySelectorAll('.block');
            let correct = true;

            buildingBlocks.forEach(block => {
                block.classList.remove('match', 'mismatch');
            });

            for (let i = 0; i < patternBlocks.length; i++) {
                if (patternBlocks[i].className === buildingBlocks[i].className &&
                    patternBlocks[i].style.backgroundColor === buildingBlocks[i].style.backgroundColor) {
                    buildingBlocks[i].classList.add('match');
                } else {
                    buildingBlocks[i].classList.add('mismatch');
                    correct = false;
                }
            }

            if (correct) {
                clearInterval(timerInterval);
                messageDisplay.textContent = 'Congratulations! You matched the pattern!';
                checkButton.disabled = true;
            } else {
                messageDisplay.textContent = 'Not quite right. Keep trying!';
            }
        }

        function startGame() {
            const pattern = generatePattern();
            setupBuildingArea(pattern);
            messageDisplay.textContent = 'Memorize the pattern! Game starts in 20 seconds...';
            startButton.disabled = true;
            
            setTimeout(() => {
                patternCard.querySelectorAll('.block').forEach(block => {
                    block.style.backgroundColor = '';
                    block.classList.remove('block-1x1', 'block-1x2', 'block-2x2');
                    block.classList.add('block-1x1');
                    block.innerHTML = '';
                });
                messageDisplay.textContent = 'Go! Rearrange the blocks to match the pattern from memory.';
                checkButton.disabled = false;
                startTimer();
            }, 20000);
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    checkButton.disabled = true;
                    messageDisplay.textContent = 'Time\'s up! Game over.';
                }
            }, 1000);
        }

        checkButton.addEventListener('click', checkPattern);
        startButton.addEventListener('click', startGame);
    </script>
</body>
</html>
